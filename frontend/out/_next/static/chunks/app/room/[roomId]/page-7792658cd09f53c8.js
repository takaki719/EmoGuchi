(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[684],{3881:function(e,t,o){Promise.resolve().then(o.bind(o,7744))},7744:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return RoomPage}});var n=o(7437),s=o(2265),r=o(4033),a=o(4337);let SocketClient=class SocketClient{connect(){var e;return(null===(e=this.socket)||void 0===e?void 0:e.connected)||(console.log("\uD83D\uDD0C Creating socket connection to:",this.url),this.socket=(0,a.io)(this.url,{transports:["polling","websocket"],autoConnect:!0,timeout:2e4,forceNew:!0}),console.log("\uD83D\uDD0C Socket created:",this.socket),this.socket.on("connect",()=>{console.log("Connected to server")}),this.socket.on("disconnect",()=>{console.log("Disconnected from server")}),this.socket.on("connect_error",e=>{console.error("Connection error:",e)})),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}getSocket(){return this.socket}isConnected(){var e;return(null===(e=this.socket)||void 0===e?void 0:e.connected)||!1}constructor(e="http://localhost:8000"){this.socket=null,this.url=e}};let i=new SocketClient;var l=o(4660);let c=(0,l.Ue)(e=>({roomState:null,isConnected:!1,playerName:"",hostToken:"",currentRound:null,speakerEmotion:null,playerVote:null,lastResult:null,gameComplete:null,audioRecording:null,audioUrl:null,recordingInProgress:!1,isAudioProcessed:!1,isLoading:!1,error:null,setRoomState:t=>e({roomState:t}),setConnected:t=>e({isConnected:t}),setPlayerName:t=>e({playerName:t}),setHostToken:t=>e({hostToken:t}),setCurrentRound:t=>e({currentRound:t,playerVote:null}),setSpeakerEmotion:t=>e({speakerEmotion:t}),setPlayerVote:t=>e({playerVote:t}),setLastResult:t=>e({lastResult:t}),setGameComplete:t=>e({gameComplete:t}),setAudioRecording:t=>e({audioRecording:t}),setAudioUrl:t=>e({audioUrl:t}),setRecordingInProgress:t=>e({recordingInProgress:t}),setAudioProcessed:t=>e({isAudioProcessed:t}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t}),reset:()=>e({roomState:null,isConnected:!1,playerName:"",hostToken:"",currentRound:null,speakerEmotion:null,playerVote:null,lastResult:null,gameComplete:null,audioRecording:null,audioUrl:null,recordingInProgress:!1,isAudioProcessed:!1,isLoading:!1,error:null})})),useSocket=()=>{let e;console.log("\uD83D\uDE80 useSocket: Function called");try{console.log("\uD83D\uDE80 useSocket: About to call useGameStore..."),e=c(),console.log("\uD83D\uDE80 useSocket: useGameStore successful")}catch(e){throw console.error("❌ useSocket: useGameStore failed:",e),e}(0,s.useEffect)(()=>{console.log("\uD83D\uDE80 useSocket: useEffect running"),console.log("\uD83D\uDE80 useSocket: Setting up socket connection"),console.log("\uD83D\uDE80 useSocket: Process env API URL:","http://localhost:8000"),console.log("\uD83D\uDE80 useSocket: About to call socketClient.connect()");let t=i.connect();console.log("\uD83D\uDE80 useSocket: Socket returned from connect():",t),console.log("\uD83D\uDE80 useSocket: Socket type:",typeof t),console.log("\uD83D\uDE80 useSocket: Socket connected:",null==t?void 0:t.connected),t.on("connect",()=>{console.log("useSocket: Connected to server"),e.setConnected(!0),e.setError(null)}),t.on("disconnect",()=>{console.log("useSocket: Disconnected from server"),e.setConnected(!1)}),t.on("connect_error",t=>{console.error("useSocket: Connection error:",t),e.setError("Connection failed: ".concat(t.message||t))}),t.on("connected",e=>{console.log("Server message:",e.message)}),t.on("room_state",t=>{e.setRoomState(t),"waiting"===t.phase&&e.setGameComplete(null)}),t.on("player_joined",e=>{console.log("".concat(e.playerName," joined the room"))}),t.on("player_reconnected",e=>{console.log("".concat(e.playerName," reconnected to the room"))}),t.on("player_left",e=>{console.log("".concat(e.playerName," left the room"))}),t.on("left_room",t=>{console.log("Successfully left room:",t.message),e.reset()}),t.on("player_disconnected",e=>{console.log("".concat(e.playerName," disconnected"))}),t.on("round_start",t=>{console.log("\uD83C\uDFAE round_start event received:",t);let o={id:t.roundId,phrase:t.phrase,emotion_id:"",speaker_name:t.speakerName,voting_choices:t.votingChoices||[]};console.log("\uD83C\uDFAE Created round object:",o),e.setCurrentRound(o),e.setLastResult(null),console.log("\uD83C\uDFAE Current player name in store:",e.playerName),console.log("\uD83C\uDFAE Round speaker name:",o.speaker_name)}),t.on("speaker_emotion",t=>{console.log("\uD83C\uDFAD speaker_emotion event received:",t),console.log("✅ Processing speaker_emotion (simplified)"),e.setSpeakerEmotion(t.emotionName||t.emotionId)}),t.on("round_result",t=>{console.log("Received round_result:",t),console.log("correct_emotion:",t.correct_emotion),console.log("correctEmotionId:",t.correctEmotionId),e.setLastResult(t),e.setCurrentRound(null),e.setSpeakerEmotion(null)}),t.on("game_complete",t=>{e.setGameComplete(t)}),t.on("audio_received",t=>{var o,n,s,r;console.log("\uD83C\uDFB5 audio_received event received:",t),console.log("Audio data type:",typeof t.audio,"size:",(null===(o=t.audio)||void 0===o?void 0:o.byteLength)||"unknown"),console.log("Audio data constructor:",null===(s=t.audio)||void 0===s?void 0:null===(n=s.constructor)||void 0===n?void 0:n.name);try{let o;if(t.audio instanceof ArrayBuffer)console.log("\uD83C\uDFB5 Converting ArrayBuffer to Blob"),o=new Blob([t.audio],{type:"audio/webm;codecs=opus"});else if(t.audio&&(null===(r=t.audio.constructor)||void 0===r?void 0:r.name)==="Uint8Array")console.log("\uD83C\uDFB5 Converting Uint8Array to Blob"),o=new Blob([t.audio.buffer],{type:"audio/webm;codecs=opus"});else if(t.audio&&"object"==typeof t.audio&&t.audio.data){console.log("\uD83C\uDFB5 Converting object with data property to Blob");let e=new Uint8Array(t.audio.data);o=new Blob([e],{type:"audio/webm;codecs=opus"})}else console.log("\uD83C\uDFB5 Unknown audio data format, trying direct conversion"),o=new Blob([t.audio],{type:"audio/webm;codecs=opus"});console.log("\uD83C\uDFB5 Created blob size:",o.size,"type:",o.type);let n=URL.createObjectURL(o);e.setAudioUrl(n),e.setAudioProcessed(t.is_processed||!1),console.log("✅ Audio URL created successfully:",n),console.log("\uD83C\uDFAF Audio processed:",t.is_processed)}catch(o){console.error("❌ Error creating audio URL:",o),console.error("❌ Audio data details:",t.audio),e.setError("音声データの処理に失敗しました")}}),t.onAny(function(e){for(var t=arguments.length,o=Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];console.log("\uD83D\uDCE1 Socket event received:",e,o),"audio_received"===e&&console.log("\uD83C\uDFB5 AUDIO_RECEIVED EVENT DETECTED!",o)});let o=t.emit;return t.emit=function(e){for(var n=arguments.length,s=Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];return console.log("\uD83D\uDCE4 Socket event SENT:",e,s),o.apply(t,[e,...s])},t.on("error",t=>{e.setError("".concat(t.code,": ").concat(t.message))}),()=>{t.off("connect"),t.off("disconnect"),t.off("connect_error"),t.off("connected"),t.off("room_state"),t.off("player_joined"),t.off("player_reconnected"),t.off("player_left"),t.off("left_room"),t.off("player_disconnected"),t.off("round_start"),t.off("speaker_emotion"),t.off("round_result"),t.off("game_complete"),t.off("audio_received"),t.offAny(),t.off("error")}},[]);let t=(0,s.useCallback)((e,t)=>{let o=i.getSocket();o&&o.emit("join_room",{roomId:e,playerName:t})},[]),o=(0,s.useCallback)(()=>{let e=i.getSocket();e&&e.emit("start_round",{})},[]),n=(0,s.useCallback)((e,t)=>{let o=i.getSocket();o&&o.emit("submit_vote",{roundId:e,emotionId:t})},[]),r=(0,s.useCallback)(()=>{let e=i.getSocket();e&&e.emit("leave_room",{})},[]),a=(0,s.useCallback)(()=>{let e=i.getSocket();e&&e.emit("restart_game",{})},[]),l=(0,s.useCallback)(e=>{let t=i.getSocket();if(console.log("\uD83D\uDD25 sendAudio called, socket available:",!!t,"connected:",null==t?void 0:t.connected),console.log("\uD83D\uDD25 Socket ID:",null==t?void 0:t.id),t&&t.connected){let o=new FileReader;o.onload=()=>{let e=o.result;console.log("\uD83D\uDD25 Sending audio data, size:",e.byteLength),console.log("\uD83D\uDD25 Audio data type:",typeof e),console.log("\uD83D\uDD25 Audio data preview:",new Uint8Array(e.slice(0,10)));try{console.log("\uD83D\uDD25 About to emit audio_send event..."),t.emit("audio_send",{audio:e}),console.log("✅ audio_send event emitted successfully with data size:",e.byteLength),setTimeout(()=>{console.log("\uD83D\uDD25 5 seconds passed since audio_send - checking for response...")},5e3)}catch(e){console.error("❌ Error emitting audio_send:",e)}},o.onerror=e=>{console.error("❌ Error reading audio blob:",e)},o.readAsArrayBuffer(e)}else console.error("❌ Socket not available or not connected for audio sending. Connected:",null==t?void 0:t.connected)},[]);return{socket:i.getSocket(),isConnected:i.isConnected(),joinRoom:t,startRound:o,submitVote:n,leaveRoom:r,restartGame:a,sendAudio:l}};var d=o(2979),m=o(879);let useMediaRecorder=()=>{let[e,t]=(0,s.useState)(!1),[o,n]=(0,s.useState)(null),[r,a]=(0,s.useState)(null),i=(0,s.useRef)(null),l=(0,s.useRef)([]),c=(0,s.useCallback)(async()=>{try{a(null);let e=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}}),o=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"});l.current=[],o.ondataavailable=e=>{e.data.size>0&&l.current.push(e.data)},o.onstop=()=>{let t=new Blob(l.current,{type:"audio/webm;codecs=opus"});n(t),e.getTracks().forEach(e=>e.stop())},i.current=o,o.start(100),t(!0)}catch(e){a("マイクアクセスが拒否されました。ブラウザの設定を確認してください。"),console.error("Recording failed:",e)}},[]),d=(0,s.useCallback)(()=>{i.current&&e&&(i.current.stop(),t(!1))},[e]),m=(0,s.useCallback)(()=>{n(null),a(null)},[]);return{isRecording:e,audioBlob:o,startRecording:c,stopRecording:d,clearRecording:m,error:r}},AudioRecorder=e=>{let{onRecordingComplete:t,disabled:o=!1}=e,{isRecording:s,audioBlob:r,startRecording:a,stopRecording:i,clearRecording:l,error:c}=useMediaRecorder(),handleStart=async()=>{l(),await a()};return(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-lg border-2 border-gray-200",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"音声録音"}),c&&(0,n.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:c}),(0,n.jsxs)("div",{className:"space-y-4",children:[!r&&!s&&(0,n.jsx)("button",{onClick:handleStart,disabled:o,className:"w-full bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200",children:"\uD83C\uDFA4 録音開始"}),s&&(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-500 rounded-full animate-pulse",children:(0,n.jsx)("div",{className:"w-4 h-4 bg-white rounded-full"})}),(0,n.jsx)("p",{className:"mt-2 text-red-600 font-medium",children:"録音中..."})]}),(0,n.jsx)("button",{onClick:()=>{i()},className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200",children:"⏹️ 録音停止"})]}),r&&(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-green-600 font-medium mb-3",children:"✅ 録音完了"}),(0,n.jsx)("audio",{controls:!0,src:URL.createObjectURL(r),className:"w-full"})]}),(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)("button",{onClick:()=>{r&&t(r)},className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200",children:"\uD83D\uDCE4 送信"}),(0,n.jsx)("button",{onClick:()=>{l()},className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200",children:"\uD83D\uDD04 再録音"})]})]})]})]})},AudioPlayer=e=>{let{audioUrl:t,speakerName:o,isProcessed:r=!1}=e,a=(0,s.useRef)(null),[i,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null),handlePlay=async()=>{if(a.current)try{d(null),await a.current.play(),l(!0)}catch(e){console.error("Error playing audio:",e),d("音声の再生に失敗しました")}};return(0,n.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-200",children:[(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h4",{className:"font-semibold text-blue-800",children:o?"".concat(o,"の音声:"):"スピーカーの音声:"}),r&&(0,n.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"\uD83C\uDFAF 音声加工済み（高難易度モード）"})]}),c&&(0,n.jsx)("div",{className:"mb-3 p-2 bg-red-100 border border-red-400 text-red-700 rounded text-sm",children:c}),(0,n.jsx)("audio",{ref:a,src:t,onEnded:()=>{l(!1)},onError:()=>{d("音声ファイルを読み込めませんでした"),l(!1)},className:"w-full mb-3",controls:!0}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:handlePlay,disabled:i,className:"flex-1 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-bold py-2 px-4 rounded transition-colors",children:i?"▶️ 再生中...":"▶️ 再生"}),(0,n.jsx)("button",{onClick:()=>{a.current&&(a.current.pause(),l(!1))},disabled:!i,className:"flex-1 bg-gray-500 hover:bg-gray-600 disabled:bg-gray-400 text-white font-bold py-2 px-4 rounded transition-colors",children:"⏸️ 停止"})]})]})};var u=o(1402);function RoomPage(e){var t,a,i;let{params:l}=e,g=(0,r.useSearchParams)(),x=g.get("name")||"",h="true"===g.get("host"),{roomId:p}=l,b=decodeURIComponent(p),{joinRoom:y,startRound:f,submitVote:j,leaveRoom:v,restartGame:D,sendAudio:N,isConnected:w}=useSocket(),{roomState:k,currentRound:C,speakerEmotion:E,playerVote:S,lastResult:R,gameComplete:A,error:_,audioUrl:F,isAudioProcessed:I,setPlayerName:P,setPlayerVote:M,setGameComplete:B,setLastResult:T,setAudioRecording:J,setAudioUrl:L}=c(),[U,O]=(0,s.useState)(""),[G,z]=(0,s.useState)(!1),[V,W]=(0,s.useState)(!1),[H,q]=(0,s.useState)(!1),[Y,X]=(0,s.useState)("basic"),[K,Z]=(0,s.useState)(1),[Q,$]=(0,s.useState)("sequential"),[ee,et]=(0,s.useState)(!1),{locale:eo}=(0,d.E)(),en=m.I[eo];(0,s.useEffect)(()=>{x&&P(x)},[x,P]),(0,s.useEffect)(()=>{(C||(null==k?void 0:k.phase)==="in_round")&&W(!1)},[C,null==k?void 0:k.phase]),(0,s.useEffect)(()=>{w&&x&&!k&&y(b,x)},[w,x,b,k,y]),(0,s.useEffect)(()=>{(null==k?void 0:k.config)&&(X(k.config.mode),Z(k.config.max_rounds),$(k.config.speaker_order),et(k.config.hard_mode||!1))},[null==k?void 0:k.config]);let handleStartRound=()=>{V||(W(!0),f(),setTimeout(()=>W(!1),2e3))},handleVote=()=>{C&&U&&(j(C.id,U),M(U),O(""))},handleCopyRoomId=async()=>{try{await navigator.clipboard.writeText(b),z(!0),setTimeout(()=>z(!1),2e3)}catch(e){console.error("Failed to copy room ID:",e),alert("".concat(en.common.roomId,": ").concat(b))}},getEmotionNameById=e=>{var t;if((null==k?void 0:null===(t=k.config)||void 0===t?void 0:t.vote_type)==="wheel"){let{PLUTCHIK_EMOTIONS_3_LAYER:t}=o(1402),n=t.find(t=>t.id===e);if(n)return"".concat(n.nameJa," (").concat(n.nameEn,")")}else{let t=es.find(t=>t.id===e);if(t)return t.name}return e},handleUpdateSettings=async()=>{try{let e=localStorage.getItem("hostToken");if(!e){alert(en.common.noHostPrivileges);return}let t=await fetch("".concat("http://localhost:8000","/api/v1/rooms/").concat(encodeURIComponent(b),"/config"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({mode:Y,vote_type:"advanced"===Y?"8choice":"wheel"===Y?"wheel":"4choice",speaker_order:Q,max_rounds:K,hard_mode:ee})});if(!t.ok){let e=await t.json().catch(()=>({detail:"Failed to update settings"}));throw Error(e.detail||"Failed to update settings")}q(!1),alert(en.common.settingsUpdated)}catch(e){console.error("Error updating settings:",e),alert("".concat(en.common.settingsUpdateFailed,": ").concat(e.message))}},es=(null==C?void 0:C.voting_choices)&&C.voting_choices.length>0?C.voting_choices:(()=>{var e;let t=[{id:"joy",name:en.emotions.joy},{id:"anger",name:en.emotions.anger},{id:"sadness",name:en.emotions.sadness},{id:"surprise",name:en.emotions.surprise}];return(null==k?void 0:null===(e=k.config)||void 0===e?void 0:e.vote_type)==="8choice"?[...t,{id:"fear",name:en.emotions.fear},{id:"disgust",name:en.emotions.disgust},{id:"trust",name:en.emotions.trust},{id:"anticipation",name:en.emotions.anticipation}]:t})(),er=(null==C?void 0:C.speaker_name)===x;return _?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md w-full text-center",children:[(0,n.jsx)("h2",{className:"text-red-800 font-bold mb-2",children:en.common.error}),(0,n.jsx)("p",{className:"text-red-600",children:_}),(0,n.jsx)("button",{onClick:()=>window.location.href="/",className:"mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:en.common.backToHome})]})}):w?k?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"min-h-screen p-2 sm:p-4",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md p-3 sm:p-6 mb-4 sm:mb-6",children:(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-0",children:[(0,n.jsxs)("div",{className:"w-full sm:w-auto",children:[(0,n.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"\uD83C\uDFAD EMOGUCHI"}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mt-1",children:[(0,n.jsxs)("span",{className:"text-sm sm:text-base text-gray-600",children:[en.common.roomId,": ",b]}),(0,n.jsx)("button",{onClick:handleCopyRoomId,className:"px-3 py-2 sm:px-2 sm:py-1 text-sm sm:text-xs rounded transition-colors self-start ".concat(G?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:en.common.copyRoomCode,children:G?"✓":"\uD83D\uDCCB"})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4 w-full sm:w-auto justify-between sm:justify-end",children:[(0,n.jsxs)("div",{className:"text-left sm:text-right",children:[(0,n.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:en.common.phase}),(0,n.jsxs)("p",{className:"font-semibold text-sm sm:text-base",children:["waiting"===k.phase&&en.common.waiting,"in_round"===k.phase&&en.common.inRound,"result"===k.phase&&en.common.result]})]}),(0,n.jsx)("button",{onClick:()=>{confirm(en.common.leaveRoomConfirm)&&(v(),setTimeout(()=>{window.location.href="/"},1e3))},className:"px-3 py-2 sm:px-3 sm:py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",title:en.common.exit,children:en.common.exit})]})]})}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-3 sm:p-6 mb-4 sm:mb-6",children:[(0,n.jsxs)("h2",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:[en.common.players," (",k.players.length,en.game.peopleCounter,")"]}),(0,n.jsx)("div",{className:"grid gap-2 sm:gap-3 ".concat(k.players.length<=4?"grid-cols-2 sm:grid-cols-4":k.players.length<=6?"grid-cols-2 sm:grid-cols-3":"grid-cols-2 sm:grid-cols-3 lg:grid-cols-4"),children:k.players.map((e,t)=>(0,n.jsxs)("div",{className:"p-2 sm:p-3 rounded-lg border-2 ".concat(e===x?"border-blue-500 bg-blue-50":e===k.currentSpeaker?"border-green-500 bg-green-50":"border-gray-200 bg-gray-50"),children:[(0,n.jsx)("div",{className:"text-xs sm:text-sm font-medium truncate",title:e,children:e}),e===x&&(0,n.jsx)("div",{className:"text-xs text-blue-600",children:en.common.you}),e===k.currentSpeaker&&(0,n.jsx)("div",{className:"text-xs text-green-600",children:en.common.speaker})]},e))})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:["waiting"===k.phase&&(0,n.jsx)("div",{className:"space-y-6",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:en.game.waitingForHost}),!R&&!A&&(0,n.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[(0,n.jsx)("h3",{className:"font-semibold mb-2",children:en.game.currentSettings}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{className:"text-gray-600",children:[en.home.gameMode,":"]}),(0,n.jsx)("span",{className:"ml-2",children:"basic"===k.config.mode?en.home.basicMode:"advanced"===k.config.mode?en.home.advancedMode:"3層感情の輪"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-gray-600",children:"最大サイクル数:"}),(0,n.jsxs)("span",{className:"ml-2",children:[k.config.max_rounds,"サイクル"]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{className:"text-gray-600",children:[en.home.speakerOrder,":"]}),(0,n.jsx)("span",{className:"ml-2",children:"sequential"===k.config.speaker_order?en.home.sequential:en.home.random})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-gray-600",children:"高難易度モード:"}),(0,n.jsx)("span",{className:"ml-2",children:k.config.hard_mode?"ON":"OFF"})]})]})]}),h&&(0,n.jsxs)("div",{className:"space-y-3",children:["waiting"===k.phase&&!R&&(0,n.jsxs)("button",{onClick:()=>q(!H),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:["⚙️ ",en.common.settings]}),H&&(0,n.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-left",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:en.home.gameMode}),(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>X("basic"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all ".concat("basic"===Y?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"),children:en.home.basicMode}),(0,n.jsx)("button",{type:"button",onClick:()=>X("advanced"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all ".concat("advanced"===Y?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"),children:en.home.advancedMode}),(0,n.jsx)("button",{type:"button",onClick:()=>X("wheel"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all ".concat("wheel"===Y?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"),children:"感情の輪"})]})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{htmlFor:"maxRounds",className:"block text-sm font-medium text-gray-700 mb-2",children:"最大サイクル数"}),(0,n.jsx)("select",{id:"maxRounds",value:K,onChange:e=>Z(Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[1,2,3,4,5].map(e=>(0,n.jsxs)("option",{value:e,children:[e,"サイクル"]},e))})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:en.home.speakerOrder}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>$("sequential"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all ".concat("sequential"===Q?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"),children:en.home.sequential}),(0,n.jsx)("button",{type:"button",onClick:()=>$("random"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all ".concat("random"===Q?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"),children:en.home.random})]})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"高難易度モード"}),(0,n.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-3",children:[(0,n.jsx)("p",{className:"text-xs text-yellow-800 mb-1",children:"\uD83C\uDFAF 音声加工でリスナーの感情判定を困難にします"}),(0,n.jsxs)("p",{className:"text-xs text-yellow-700",children:["• ピッチ・テンポ変更による印象操作",(0,n.jsx)("br",{}),"• 感情逆転変換による誤誘導",(0,n.jsx)("br",{}),"• スピーカーには原音、リスナーには加工音声"]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>et(!1),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all ".concat(ee?"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50":"bg-blue-600 text-white"),children:"OFF（通常）"}),(0,n.jsx)("button",{type:"button",onClick:()=>et(!0),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all ".concat(ee?"bg-red-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"),children:"ON（高難易度）"})]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:handleUpdateSettings,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors",children:en.common.save}),(0,n.jsx)("button",{onClick:()=>q(!1),className:"flex-1 bg-gray-400 text-white py-2 px-4 rounded-lg hover:bg-gray-500 transition-colors",children:en.common.cancel})]})]}),"waiting"===k.phase&&!R&&(0,n.jsx)("button",{onClick:handleStartRound,disabled:k.players.length<2||V||H,className:"px-6 py-3 rounded-lg font-medium ".concat(k.players.length<2||V||H?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:V?en.game.starting:H?"設定変更中...":k.players.length<2?en.game.minimumPlayers:"\uD83C\uDFAE ".concat(en.game.gameStart)})]})]})}),"in_round"===k.phase&&(0,n.jsxs)("div",{className:"space-y-6",children:[C?(0,n.jsx)(n.Fragment,{children:er?(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4 text-orange-700",children:en.game.youAreSpeakerTitle}),(0,n.jsxs)("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"font-bold text-orange-800 mb-3 text-lg",children:en.game.performWith}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold text-orange-700 mb-1",children:en.game.script}),(0,n.jsx)("p",{className:"text-xl font-medium text-orange-900 bg-white p-3 rounded border",children:C.phrase})]}),E&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold text-orange-700 mb-1",children:en.game.emotion}),(0,n.jsx)("p",{className:"text-lg font-medium text-orange-900 bg-white p-3 rounded border",children:E})]})]}),(0,n.jsx)("p",{className:"text-sm text-orange-700 mt-4 font-medium",children:en.game.speakerInstructions}),(null==k?void 0:null===(a=k.config)||void 0===a?void 0:a.hard_mode)&&(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mt-3",children:[(0,n.jsxs)("p",{className:"text-sm text-red-700",children:["\uD83C\uDFAF ",(0,n.jsx)("strong",{children:"高難易度モード"}),"：あなたの音声はリスナーに加工されて届きます"]}),(0,n.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"あなたには原音が聞こえますが、リスナーには加工音声が再生されます"})]})]}),(0,n.jsxs)("div",{className:"mt-6",children:[(0,n.jsx)(AudioRecorder,{onRecordingComplete:e=>{console.log("\uD83C\uDFA4 handleAudioRecording called with blob:",e),console.log("Blob size:",e.size,"type:",e.type),J(e),N(e),console.log("\uD83D\uDCE4 Audio sent to server via sendAudio function")},disabled:!1}),!E&&(0,n.jsx)("p",{className:"text-sm text-orange-600 mt-2",children:"⚠️ 感情情報を受信中... (録音は有効です)"})]})]}):(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold mb-2",children:[en.game.speakerIs," ",C.speaker_name]}),(null==k?void 0:null===(t=k.config)||void 0===t?void 0:t.hard_mode)&&(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-3",children:[(0,n.jsxs)("p",{className:"text-sm text-red-700",children:["\uD83C\uDFAF ",(0,n.jsx)("strong",{children:"高難易度モード"}),"：音声が加工されています"]}),(0,n.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"ピッチ・テンポ変更や感情逆転により判定が困難になっています"})]}),(0,n.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,n.jsx)("p",{className:"text-lg",children:C.phrase})}),(0,n.jsx)("div",{className:"mt-4",children:F?(0,n.jsx)(AudioPlayer,{audioUrl:F,speakerName:C.speaker_name,isProcessed:I}):(0,n.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg border-2 border-gray-300",children:(0,n.jsx)("p",{className:"text-gray-600 text-center",children:"\uD83D\uDCE2 スピーカーの音声を待っています..."})})})]})}):(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{children:en.common.loadingRoundData})]}),C&&!er&&!S&&(0,n.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,n.jsx)("h3",{className:"font-semibold text-sm sm:text-base",children:en.game.guessEmotion}),(null==k?void 0:null===(i=k.config)||void 0===i?void 0:i.vote_type)==="wheel"?(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-6",children:[(0,n.jsx)(u.default,{selectedEmotion:U,onEmotionSelect:O,size:400}),(0,n.jsx)("button",{onClick:handleVote,disabled:!U,className:"w-full max-w-md bg-green-600 text-white py-3 sm:py-4 rounded-lg hover:bg-green-700 disabled:bg-gray-400 font-medium text-sm sm:text-base",children:en.game.vote})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"grid gap-2 sm:gap-3 ".concat(es.length<=4?"grid-cols-2":"grid-cols-2 sm:grid-cols-4"),children:es.map(e=>(0,n.jsx)("button",{onClick:()=>O(e.id),className:"p-3 sm:p-4 rounded-lg border-2 transition-colors text-sm sm:text-base ".concat(U===e.id?"border-blue-500 bg-blue-50 font-semibold":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:e.name},e.id))}),(0,n.jsx)("button",{onClick:handleVote,disabled:!U,className:"w-full bg-green-600 text-white py-3 sm:py-4 rounded-lg hover:bg-green-700 disabled:bg-gray-400 font-medium text-sm sm:text-base",children:en.game.vote})]})]}),C&&!er&&S&&(0,n.jsxs)("div",{className:"text-center space-y-3",children:[(0,n.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,n.jsx)("p",{className:"text-blue-800 font-semibold mb-2",children:en.game.voteComplete}),(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsxs)("span",{className:"text-blue-600",children:[en.game.yourVote,": "]}),(0,n.jsx)("span",{className:"font-medium text-blue-800",children:getEmotionNameById(S)})]})]}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:en.game.waitingForOthers})]})]}),R&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-center",children:en.game.resultAnnouncement}),R.votes&&R.votes[x]?(0,n.jsx)("div",{className:"p-4 rounded-lg border-2 ".concat((()=>{let e=R.votes[x],t=R.correctEmotionId;return t&&e===t?"border-green-400 bg-green-50":"border-red-400 bg-red-50"})()),children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-xl font-bold mb-2 ".concat((()=>{let e=R.votes[x],t=R.correctEmotionId;return t&&e===t?"text-green-700":"text-red-700"})()),children:(()=>{let e=R.votes[x],t=R.correctEmotionId;return t&&e===t?en.game.correctEmoji:en.game.incorrectEmoji})()}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("p",{className:"text-sm",children:[(0,n.jsxs)("span",{className:"text-gray-600",children:[en.game.yourVoteLabel," "]}),(0,n.jsx)("span",{className:"font-medium",children:getEmotionNameById(R.votes[x])})]}),(0,n.jsxs)("p",{className:"text-sm",children:[(0,n.jsxs)("span",{className:"text-gray-600",children:[en.game.correctAnswerLabel," "]}),(0,n.jsx)("span",{className:"font-medium",children:R.correct_emotion})]})]}),(()=>{let e=R.votes[x],t=R.correctEmotionId;return t&&e===t?(0,n.jsx)("p",{className:"text-green-700 text-sm mt-2 font-medium",children:en.game.pointsEarned}):(0,n.jsx)("p",{className:"text-red-700 text-sm mt-2 font-medium",children:en.game.noPointsThisTime})})()]})}):(0,n.jsxs)("div",{className:"bg-blue-50 p-6 rounded-lg text-center border border-blue-200",children:[(0,n.jsx)("p",{className:"text-lg font-semibold text-blue-700 mb-2",children:en.game.youWereSpeaker}),(0,n.jsxs)("p",{className:"text-xl font-bold",children:[en.game.correctAnswerLabel," ",R.correct_emotion]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("h3",{className:"font-semibold mb-2",children:[en.common.currentScore,":"]}),(0,n.jsx)("div",{className:"space-y-2",children:Object.entries(R.scores).map(e=>{let[t,o]=e;return(0,n.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,n.jsx)("span",{children:t}),(0,n.jsxs)("span",{className:"font-semibold",children:[o,"pt"]})]},t)})})]}),h&&!R.isGameComplete&&(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsx)("button",{onClick:handleStartRound,disabled:V,className:"w-full py-3 rounded-lg font-medium ".concat(V?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:V?en.game.preparing:en.game.nextRoundArrow})}),R.isGameComplete&&(0,n.jsxs)("div",{className:"text-center bg-yellow-50 p-4 rounded-lg",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:en.game.gameEndEmoji}),(0,n.jsxs)("p",{className:"text-yellow-700",children:[R.completedCycles||Math.floor((R.completedRounds||0)/k.players.length),"/",R.maxCycles||R.maxRounds,en.game.cyclesCompleted]})]})]}),A&&(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-center text-gold",children:en.game.finalResultsEmoji}),(0,n.jsxs)("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 p-6 rounded-lg border-2 border-yellow-200",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-4 text-center",children:en.game.ranking}),(0,n.jsx)("div",{className:"space-y-3",children:A.rankings.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg ".concat(0===t?"bg-yellow-100 border-2 border-yellow-400":1===t?"bg-gray-100 border-2 border-gray-400":2===t?"bg-orange-100 border-2 border-orange-400":"bg-white border border-gray-200"),children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"text-2xl font-bold ".concat(0===t?"text-yellow-600":1===t?"text-gray-600":2===t?"text-orange-600":"text-gray-500"),children:0===t?"\uD83E\uDD47":1===t?"\uD83E\uDD48":2===t?"\uD83E\uDD49":"".concat(e.rank).concat(en.common.rank)}),(0,n.jsxs)("span",{className:"font-semibold ".concat(e.name===x?"text-blue-600":"text-gray-800"),children:[e.name,e.name===x&&" (".concat(en.common.you,")")]})]}),(0,n.jsxs)("span",{className:"text-xl font-bold text-gray-800",children:[e.score,"pt"]})]},e.name))}),(0,n.jsx)("div",{className:"mt-6 text-center text-gray-600",children:(0,n.jsx)("p",{children:en.game.allRoundsComplete.replace("{rounds}",A.totalRounds.toString())})})]}),h&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("button",{onClick:()=>{B(null),T(null),D()},className:"w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 font-medium",children:en.game.playAgainEmoji}),(0,n.jsx)("p",{className:"text-center text-sm text-gray-500",children:en.game.resetMessage})]}),!h&&(0,n.jsx)("div",{className:"text-center text-gray-600",children:(0,n.jsx)("p",{children:en.game.waitingForNextGame})})]})]})]})})}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{children:en.common.joiningRoom})]})}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{children:en.common.connecting})]})})}},1402:function(e,t,o){"use strict";o.r(t),o.d(t,{PLUTCHIK_EMOTIONS_3_LAYER:function(){return r},default:function(){return EmotionWheel3Layer}});var n=o(7437),s=o(2265);let r=[{id:"joy_strong",axis:"joy",intensity:"strong",nameJa:"陶酔",nameEn:"Ecstasy",color:"#FFD700",angle:0,emoji:"\uD83E\uDD29"},{id:"joy_medium",axis:"joy",intensity:"medium",nameJa:"喜び",nameEn:"Joy",color:"#FFE55C",angle:0,emoji:"\uD83D\uDE0A"},{id:"joy_weak",axis:"joy",intensity:"weak",nameJa:"平穏",nameEn:"Serenity",color:"#FFF2B8",angle:0,emoji:"\uD83D\uDE0C"},{id:"trust_strong",axis:"trust",intensity:"strong",nameJa:"敬愛",nameEn:"Admiration",color:"#32CD32",angle:45,emoji:"\uD83E\uDD1D"},{id:"trust_medium",axis:"trust",intensity:"medium",nameJa:"信頼",nameEn:"Trust",color:"#90EE90",angle:45,emoji:"\uD83D\uDE0A"},{id:"trust_weak",axis:"trust",intensity:"weak",nameJa:"容認",nameEn:"Acceptance",color:"#C8F7C5",angle:45,emoji:"\uD83D\uDE42"},{id:"fear_strong",axis:"fear",intensity:"strong",nameJa:"恐怖",nameEn:"Terror",color:"#800080",angle:90,emoji:"\uD83D\uDE31"},{id:"fear_medium",axis:"fear",intensity:"medium",nameJa:"恐れ",nameEn:"Fear",color:"#9370DB",angle:90,emoji:"\uD83D\uDE30"},{id:"fear_weak",axis:"fear",intensity:"weak",nameJa:"不安",nameEn:"Apprehension",color:"#C8A2C8",angle:90,emoji:"\uD83D\uDE1F"},{id:"surprise_strong",axis:"surprise",intensity:"strong",nameJa:"驚嘆",nameEn:"Amazement",color:"#1E90FF",angle:135,emoji:"\uD83D\uDE31"},{id:"surprise_medium",axis:"surprise",intensity:"medium",nameJa:"驚き",nameEn:"Surprise",color:"#87CEEB",angle:135,emoji:"\uD83D\uDE32"},{id:"surprise_weak",axis:"surprise",intensity:"weak",nameJa:"放心",nameEn:"Distraction",color:"#B6E2FF",angle:135,emoji:"\uD83D\uDE10"},{id:"sadness_strong",axis:"sadness",intensity:"strong",nameJa:"悲嘆",nameEn:"Grief",color:"#000080",angle:180,emoji:"\uD83D\uDE2D"},{id:"sadness_medium",axis:"sadness",intensity:"medium",nameJa:"悲しみ",nameEn:"Sadness",color:"#4169E1",angle:180,emoji:"\uD83D\uDE22"},{id:"sadness_weak",axis:"sadness",intensity:"weak",nameJa:"哀愁",nameEn:"Pensiveness",color:"#87CEEB",angle:180,emoji:"\uD83D\uDE14"},{id:"disgust_strong",axis:"disgust",intensity:"strong",nameJa:"強い嫌悪",nameEn:"Loathing",color:"#654321",angle:225,emoji:"\uD83E\uDD2E"},{id:"disgust_medium",axis:"disgust",intensity:"medium",nameJa:"嫌悪",nameEn:"Disgust",color:"#8B4513",angle:225,emoji:"\uD83E\uDD22"},{id:"disgust_weak",axis:"disgust",intensity:"weak",nameJa:"うんざり",nameEn:"Boredom",color:"#D2B48C",angle:225,emoji:"\uD83D\uDE12"},{id:"anger_strong",axis:"anger",intensity:"strong",nameJa:"激怒",nameEn:"Rage",color:"#DC143C",angle:270,emoji:"\uD83D\uDE21"},{id:"anger_medium",axis:"anger",intensity:"medium",nameJa:"怒り",nameEn:"Anger",color:"#FF4500",angle:270,emoji:"\uD83D\uDE20"},{id:"anger_weak",axis:"anger",intensity:"weak",nameJa:"苛立ち",nameEn:"Annoyance",color:"#FF8C69",angle:270,emoji:"\uD83D\uDE24"},{id:"anticipation_strong",axis:"anticipation",intensity:"strong",nameJa:"攻撃",nameEn:"Vigilance",color:"#FF8C00",angle:315,emoji:"\uD83D\uDC41️"},{id:"anticipation_medium",axis:"anticipation",intensity:"medium",nameJa:"期待",nameEn:"Anticipation",color:"#FFA500",angle:315,emoji:"\uD83E\uDD14"},{id:"anticipation_weak",axis:"anticipation",intensity:"weak",nameJa:"関心",nameEn:"Interest",color:"#FFCC99",angle:315,emoji:"\uD83E\uDDD0"}];function EmotionWheel3Layer(e){let{selectedEmotion:t,onEmotionSelect:o,disabled:a=!1,size:i=400}=e,[l,c]=(0,s.useState)(null),[d,m]=(0,s.useState)(null),[u,g]=(0,s.useState)(!1),[x,h]=(0,s.useState)({x:0,y:0}),p=i/2,b=i/2,y=.45*i,f=.32*i,j=.19*i,v=.08*i,getRadiusForIntensity=e=>{switch(e){case"strong":default:return{inner:v,outer:j};case"medium":return{inner:j,outer:f};case"weak":return{inner:f,outer:y}}},createSegmentPath=e=>{let t=(e.angle-22.5)*Math.PI/180,o=(e.angle+22.5)*Math.PI/180,n=getRadiusForIntensity(e.intensity),s=p+n.inner*Math.cos(t),r=b+n.inner*Math.sin(t),a=p+n.outer*Math.cos(t),i=b+n.outer*Math.sin(t),l=p+n.outer*Math.cos(o),c=b+n.outer*Math.sin(o),d=p+n.inner*Math.cos(o),m=b+n.inner*Math.sin(o);return"M ".concat(s," ").concat(r," L ").concat(a," ").concat(i," A ").concat(n.outer," ").concat(n.outer," 0 0 1 ").concat(l," ").concat(c," L ").concat(d," ").concat(m," A ").concat(n.inner," ").concat(n.inner," 0 0 0 ").concat(s," ").concat(r," Z")},getTextPosition=e=>{let t=getRadiusForIntensity(e.intensity),o=(t.outer+t.inner)/2,n=e.angle*Math.PI/180;return{x:p+o*Math.cos(n),y:b+o*Math.sin(n)}},handleEmotionClick=e=>{!a&&o&&o(e)},handleEmotionHover=(e,t)=>{a||(m(e.id),g(!0),h({x:t.clientX,y:t.clientY}))},handleAxisLeave=()=>{m(null),g(!1)},isSelected=e=>t===e,isHovered=e=>l===e,getFontSize=e=>{switch(e){case"strong":case"medium":default:return .035*i;case"weak":return .03*i}},D=t?r.find(e=>e.id===t):null;return(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsxs)("svg",{width:i,height:i,viewBox:"0 0 ".concat(i," ").concat(i),className:"".concat(a?"opacity-50":"cursor-pointer"," max-w-full h-auto"),children:[(0,n.jsxs)("defs",{children:[(0,n.jsx)("filter",{id:"shadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:(0,n.jsx)("feDropShadow",{dx:"2",dy:"2",stdDeviation:"3",floodOpacity:"0.3"})}),(0,n.jsxs)("filter",{id:"innerShadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[(0,n.jsx)("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"2"}),(0,n.jsx)("feOffset",{dx:"1",dy:"1",result:"offset"}),(0,n.jsx)("feFlood",{floodColor:"#000000",floodOpacity:"0.2"}),(0,n.jsx)("feComposite",{in2:"offset",operator:"in"}),(0,n.jsxs)("feMerge",{children:[(0,n.jsx)("feMergeNode",{}),(0,n.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})]}),r.map(e=>{let t=getTextPosition(e),o=isSelected(e.id),s=isHovered(e.id);return(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:createSegmentPath(e),fill:e.color,stroke:o?"#000":"#fff",strokeWidth:o?2:.5,opacity:o?1:s?.9:.8,filter:o||s?"url(#shadow)":"url(#innerShadow)",onClick:()=>handleEmotionClick(e.id),onMouseEnter:t=>{a||(c(e.id),handleEmotionHover(e,t))},onMouseLeave:()=>{c(null),handleAxisLeave()},className:"".concat(a?"":"hover:opacity-95 transition-all duration-200")}),(0,n.jsx)("rect",{x:t.x-1.2*getFontSize(e.intensity),y:t.y-.4*getFontSize(e.intensity),width:2.4*getFontSize(e.intensity),height:.8*getFontSize(e.intensity),fill:"rgba(0, 0, 0, 0.4)",rx:"3",ry:"3",pointerEvents:"none"}),(0,n.jsx)("text",{x:t.x,y:t.y,textAnchor:"middle",dominantBaseline:"middle",fontSize:getFontSize(e.intensity),fontWeight:"bold",fill:"#fff",pointerEvents:"none",className:"select-none",style:{filter:"drop-shadow(0px 0px 3px rgba(0,0,0,0.8))"},children:e.nameJa})]},e.id)}),(0,n.jsx)("circle",{cx:p,cy:b,r:v,fill:"#f8f9fa",stroke:"#ddd",strokeWidth:"1"}),D?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("text",{x:p,y:b-.025*i,textAnchor:"middle",dominantBaseline:"middle",fontSize:.025*i,fill:"#333",fontWeight:"bold",className:"select-none",children:D.nameJa}),(0,n.jsxs)("text",{x:p,y:b,textAnchor:"middle",dominantBaseline:"middle",fontSize:.02*i,fill:"#666",className:"select-none",children:["(",D.nameEn,")"]}),(0,n.jsx)("text",{x:p,y:b+.025*i,textAnchor:"middle",dominantBaseline:"middle",fontSize:.018*i,fill:"#888",className:"select-none",children:"strong"===D.intensity?"強":"medium"===D.intensity?"中":"弱"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("text",{x:p,y:b-.01*i,textAnchor:"middle",dominantBaseline:"middle",fontSize:.025*i,fill:"#666",fontWeight:"bold",className:"select-none",children:"感情の輪"}),(0,n.jsx)("text",{x:p,y:b+.02*i,textAnchor:"middle",dominantBaseline:"middle",fontSize:.02*i,fill:"#888",className:"select-none",children:"3層構造"})]}),(0,n.jsx)("circle",{cx:p,cy:b,r:j,fill:"none",stroke:"#ddd",strokeWidth:"1",opacity:"0.5"}),(0,n.jsx)("circle",{cx:p,cy:b,r:f,fill:"none",stroke:"#ddd",strokeWidth:"1",opacity:"0.5"})]}),u&&d&&(0,n.jsx)("div",{className:"fixed z-50 bg-gray-800 text-white text-sm rounded-lg p-3 shadow-lg max-w-xs pointer-events-none",style:{left:x.x+10,top:x.y-10,transform:x.x>window.innerWidth-200?"translateX(-100%)":"none"},children:(()=>{let e=r.find(e=>e.id===d);if(!e)return null;let t="strong"===e.intensity?"強":"medium"===e.intensity?"中":"弱";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"font-semibold mb-1",children:[e.nameJa," (",e.nameEn,")"]}),(0,n.jsxs)("div",{className:"text-xs mb-1",children:["強度: ",t]}),(0,n.jsxs)("div",{className:"text-xs text-gray-300",children:[e.axis,"軸の感情"]})]})})()}),(0,n.jsxs)("div",{className:"mt-4 text-xs text-gray-600 text-center",children:[(0,n.jsx)("div",{className:"mb-1",children:"内側から外側へ: 強 → 中 → 弱"}),(0,n.jsx)("div",{children:"クリックして感情を選択・ホバーで感情の詳細を表示"})]})]})}},879:function(e,t,o){"use strict";o.d(t,{I:function(){return n}});let n={ja:{common:{roomId:"合言葉",copy:"コピー",copied:"コピー済み",exit:"退出",settings:"設定変更",save:"設定を保存",cancel:"キャンセル",phase:"フェーズ",waiting:"待機中",inRound:"ラウンド中",result:"結果発表",players:"プレイヤー",you:"あなた",speaker:"スピーカー",correct:"正解",incorrect:"不正解",points:"ポイント獲得！",noPoints:"今回はポイントなし",currentScore:"現在のスコア",language:"言語",error:"エラー",backToHome:"ホームに戻る",connecting:"サーバーに接続中...",joiningRoom:"ルームに参加中...",copyRoomCode:"合言葉をコピー",leaveRoomConfirm:"本当にルームから退出しますか？",noHostPrivileges:"ホスト権限がありません",settingsUpdated:"設定を更新しました",settingsUpdateFailed:"設定の更新に失敗しました",loadingRoundData:"ラウンドデータを読み込み中...",rank:"位"},home:{title:"EMOGUCHI",subtitle:"声の感情推理ゲーム",createRoom:"ルーム作成",joinRoom:"ルーム参加",customRoomId:"カスタム合言葉（任意）",customRoomIdPlaceholder:"例: たのしいゲーム",playerName:"プレイヤー名",playerNamePlaceholder:"例: 田中太郎",roomIdToJoin:"参加する合言葉",roomIdPlaceholder:"例: あいうえお123",gameMode:"感情モード",basicMode:"基本感情 (4択)",advancedMode:"応用感情 (8択)",speakerOrder:"発言順",sequential:"順番",random:"ランダム",maxRounds:"ラウンド数",rounds:"周"},game:{waitingForHost:"ホストがゲームを開始するのを待っています...",currentSettings:"現在の設定",gameStart:"ゲーム開始",minimumPlayers:"2人以上必要",starting:"開始中...",youAreSpeaker:"あなたがスピーカーです",performWith:"演技してください:",script:"セリフ:",emotion:"感情:",speakerInstruction:"この感情でセリフを読み上げてください。他の参加者があなたの感情を推測します。",guessEmotion:"感情を推測してください:",vote:"投票する",voteComplete:"投票完了！",yourVote:"あなたの投票:",waitingForOthers:"他のプレイヤーを待っています...",resultAnnouncement:"結果発表",correctAnswer:"正解:",yourAnswer:"あなたの投票:",nextRound:"次のラウンドへ",preparing:"準備中...",gameEnd:"ゲーム終了！",finalResults:"最終結果発表",ranking:"順位表",totalRounds:"全{rounds}ラウンドお疲れ様でした！",nextGameSettings:"次のゲーム設定",playAgain:"もう一度プレイ",resetMessage:"スコアをリセットして新しいゲームを開始します",waitingForNextGame:"ホストが次のゲームを開始するのを待っています...",youWereSpeaker:"あなたはスピーカーでした",speakerIs:"スピーカー:",listenAndGuess:"スピーカーが演技するのを聞いて、感情を推測してください",youAreSpeakerTitle:"\uD83C\uDFAD あなたがスピーカーです",speakerInstructions:"この感情でセリフを読み上げてください。他の参加者があなたの感情を推測します。",correctEmoji:"\uD83C\uDF89 正解！",incorrectEmoji:"❌ 不正解",yourVoteLabel:"あなたの投票:",correctAnswerLabel:"正解:",pointsEarned:"+1ポイント獲得！",noPointsThisTime:"今回はポイントなし",roundProgress:"ラウンド",nextRoundArrow:"➡️ 次のラウンドへ",gameEndEmoji:"\uD83C\uDF89 ゲーム終了！",roundsCompleted:"ラウンド完了",cyclesCompleted:"サイクル完了",finalResultsEmoji:"\uD83C\uDFC6 最終結果発表",allRoundsComplete:"全{rounds}ラウンドお疲れ様でした！",playAgainEmoji:"\uD83D\uDD04 もう一度プレイ",peopleCounter:"名"},emotions:{joy:"喜び",anger:"怒り",sadness:"悲しみ",surprise:"驚き",fear:"恐れ",disgust:"嫌悪",trust:"信頼",anticipation:"期待"}},en:{common:{roomId:"Room Code",copy:"Copy",copied:"Copied",exit:"Exit",settings:"Settings",save:"Save Settings",cancel:"Cancel",phase:"Phase",waiting:"Waiting",inRound:"In Round",result:"Results",players:"Players",you:"You",speaker:"Speaker",correct:"Correct",incorrect:"Incorrect",points:"Points earned!",noPoints:"No points this time",currentScore:"Current Score",language:"Language",error:"Error",backToHome:"Back to Home",connecting:"Connecting to server...",joiningRoom:"Joining room...",copyRoomCode:"Copy room code",leaveRoomConfirm:"Are you sure you want to leave the room?",noHostPrivileges:"No host privileges",settingsUpdated:"Settings updated",settingsUpdateFailed:"Failed to update settings",loadingRoundData:"Loading round data...",rank:"th"},home:{title:"EMOGUCHI",subtitle:"Voice Emotion Guessing Game",createRoom:"Create Room",joinRoom:"Join Room",customRoomId:"Custom Room Code (Optional)",customRoomIdPlaceholder:"e.g. FunGame123",playerName:"Player Name",playerNamePlaceholder:"e.g. John Doe",roomIdToJoin:"Room Code to Join",roomIdPlaceholder:"e.g. abc123",gameMode:"Emotion Mode",basicMode:"Basic Emotions (4 choices)",advancedMode:"Advanced Emotions (8 choices)",speakerOrder:"Speaker Order",sequential:"Sequential",random:"Random",maxRounds:"Number of Rounds",rounds:"rounds"},game:{waitingForHost:"Waiting for host to start the game...",currentSettings:"Current Settings",gameStart:"Start Game",minimumPlayers:"Need 2+ players",starting:"Starting...",youAreSpeaker:"You are the Speaker",performWith:"Please perform:",script:"Script:",emotion:"Emotion:",speakerInstruction:"Read this script with the given emotion. Other players will guess your emotion.",guessEmotion:"Guess the emotion:",vote:"Vote",voteComplete:"Vote Complete!",yourVote:"Your vote:",waitingForOthers:"Waiting for other players...",resultAnnouncement:"Results",correctAnswer:"Correct Answer:",yourAnswer:"Your Answer:",nextRound:"Next Round",preparing:"Preparing...",gameEnd:"Game Over!",finalResults:"Final Results",ranking:"Rankings",totalRounds:"Great job on all {rounds} rounds!",nextGameSettings:"Next Game Settings",playAgain:"Play Again",resetMessage:"Reset scores and start a new game",waitingForNextGame:"Waiting for host to start the next game...",youWereSpeaker:"You were the Speaker",speakerIs:"Speaker:",listenAndGuess:"Listen to the speaker and guess their emotion",youAreSpeakerTitle:"\uD83C\uDFAD You are the Speaker",speakerInstructions:"Read this script with the given emotion. Other players will guess your emotion.",correctEmoji:"\uD83C\uDF89 Correct!",incorrectEmoji:"❌ Incorrect",yourVoteLabel:"Your vote:",correctAnswerLabel:"Correct Answer:",pointsEarned:"+1 point earned!",noPointsThisTime:"No points this time",roundProgress:"Round",nextRoundArrow:"➡️ Next Round",gameEndEmoji:"\uD83C\uDF89 Game Over!",roundsCompleted:"rounds completed",cyclesCompleted:"cycles completed",finalResultsEmoji:"\uD83C\uDFC6 Final Results",allRoundsComplete:"Great job on all {rounds} rounds!",playAgainEmoji:"\uD83D\uDD04 Play Again",peopleCounter:""},emotions:{joy:"Joy",anger:"Anger",sadness:"Sadness",surprise:"Surprise",fear:"Fear",disgust:"Disgust",trust:"Trust",anticipation:"Anticipation"}}}},2979:function(e,t,o){"use strict";o.d(t,{E:function(){return r}});var n=o(4660),s=o(4810);let r=(0,n.Ue)()((0,s.tJ)(e=>({locale:"ja",setLocale:t=>e({locale:t})}),{name:"emoguchi-locale"}))}},function(e){e.O(0,[353,337,971,158,744],function(){return e(e.s=3881)}),_N_E=e.O()}]);